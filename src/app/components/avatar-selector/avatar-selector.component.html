<div class="avatar-selector w-100">
  <!-- Avatar Preview -->
  <div class="text-center mb-3">
    <div class="avatar-preview">
      <div class="position-relative d-inline-block">
        <!-- Mostrar foto subida o icono de FontAwesome -->
        <div *ngIf="fotoUrl; else avatarIcon" class="avatar-container">
          <img [src]="fotoUrl"
               alt="Foto del afiliado"
               class="rounded border shadow-sm"
               width="100"
               height="100"
               style="object-fit: cover; border: 3px solid #dee2e6;">
        </div>

        <!-- Template para icono por defecto - SIN fondo circular -->
        <ng-template #avatarIcon>
          <div class="avatar-icon-container d-flex align-items-center justify-content-center"
               style="width: 100px; height: 100px;">
            <i [class]="selectedIcon"
               [style.color]="selectedColor"
               [style.font-size]="iconSize"
               class="avatar-icon-simple"></i>
          </div>
        </ng-template>

        <!-- Indicador de tipo -->
        <div class="avatar-overlay">
          <i class="fas fa-camera text-primary" *ngIf="fotoUrl; else robotIcon" style="font-size: 0.8rem;"></i>
          <ng-template #robotIcon>
            <i class="fas fa-user-circle text-primary" style="font-size: 0.8rem;"></i>
          </ng-template>
        </div>
      </div>
    </div>

    <!-- Nombre del avatar o foto -->
    <div class="mt-2">
      <small class="text-muted">
        {{ fotoUrl ? 'Foto personalizada' : 'Icono por defecto' }}
      </small>
    </div>
  </div>

  <!-- Botones de acción -->
  <div class="avatar-actions mb-3">
    <div class="d-grid gap-2">
      <!-- Subir foto -->
      <label class="btn btn-outline-primary btn-sm">
        <i class="fas fa-camera me-1"></i>{{ fotoUrl ? 'Cambiar foto' : 'Subir foto' }}
        <input type="file"
               class="d-none"
               accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
               (change)="onFileSelected($event)">
      </label>

      <!-- Remover foto (solo si hay foto) -->
      <button type="button"
              *ngIf="fotoUrl"
              class="btn btn-outline-danger btn-sm"
              (click)="removeFoto()">
        <i class="fas fa-trash me-1"></i>Quitar foto
      </button>
    </div>

    <!-- Información sobre límites -->
    <div class="mt-2">
      <small class="text-muted">
        <i class="fas fa-info-circle me-1"></i>
        Máximo 4MB • JPEG, PNG, GIF, WebP
      </small>
    </div>
  </div>
</div>
