<div class="container mt-4">
  <h2 class="mb-4">Registro de Afiliados</h2>

  <!-- Formulario -->
  <form [formGroup]="form" (ngSubmit)="guardar()" class="row g-3" novalidate>
    <div class="col-md-6">
      <label class="form-label">Apellido y Nombre</label>
      <input formControlName="apellidoNombre" class="form-control" required />
      <div *ngIf="form.get('apellidoNombre')?.invalid && form.get('apellidoNombre')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <div class="col-md-3">
      <label class="form-label">DNI</label>
      <input formControlName="dni" class="form-control" required />
      <div *ngIf="form.get('dni')?.invalid && form.get('dni')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <div class="col-md-3">
      <label class="form-label">Fecha Nacimiento</label>
      <input type="date" formControlName="fechaNacimiento" class="form-control" required />
      <div *ngIf="form.get('fechaNacimiento')?.invalid && form.get('fechaNacimiento')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <div class="col-md-3">
      <label class="form-label">N° Afiliación</label>
      <input formControlName="numeroAfiliacion" class="form-control" readonly />
    </div>

    <div class="col-md-3">
      <label class="form-label">Tipo Afiliación</label>
      <select formControlName="tipoAfiliacion" class="form-select" required>
        <option value="">Seleccione...</option>
        <option value="FJV">FJV</option>
        <option value="FEVA">FEVA</option>
      </select>
      <div *ngIf="form.get('tipoAfiliacion')?.invalid && form.get('tipoAfiliacion')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <!-- Categoría 1 -->
    <div class="col-md-3">
      <label class="form-label d-flex justify-content-between align-items-center">
        Categoría 1
        <button type="button" class="btn btn-sm btn-link p-0" (click)="editarCategorias('categoria1')">Editar</button>
      </label>
      <select formControlName="categoria1" class="form-select" required>
        <option value="">Seleccione...</option>
        <option>Jugador</option>
        <option>Jugadora</option>
        <option>Entrenador</option>
        <option>Entrenadora</option>
        <option>Arbitro</option>
        <option>Arbitra</option>
        <option>Planillero</option>
      </select>
      <div *ngIf="form.get('categoria1')?.invalid && form.get('categoria1')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <!-- Categoría 2 -->
    <div class="col-md-3">
      <label class="form-label d-flex justify-content-between align-items-center">
        Categoría 2
        <button type="button" class="btn btn-sm btn-link p-0" (click)="editarCategorias('categoria2')">Editar</button>
      </label>
      <select formControlName="categoria2" class="form-select" required>
        <option value="">Seleccione...</option>
        <option>Mini</option>
        <option>Sub12</option>
        <option>Sub14</option>
        <option>Sub16</option>
        <option>Sub18</option>
        <option>Sub20</option>
        <option>Mayores</option>
        <option>Beach</option>
        <option>Maxi</option>
        <option>Newcom</option>
        <option>FJV Aspirante</option>
        <option>FEVA Provincial N1</option>
        <option>FEVA Provincial N2</option>
        <option>FEVA Nacional N1</option>
        <option>FEVA Nacional N2</option>
        <option>FIVB Internacional N1</option>
        <option>FIVB Internacional N2</option>
        <option>FIVB Internacional N3</option>
        <option>A.FJV Local</option>
        <option>A.FJV Provincial</option>
        <option>A.Cand.Nacional</option>
        <option>A.FEVA Nacional</option>
        <option>A.Cand. Continental</option>
        <option>Arbitro Continental</option>
        <option>Arbitro Intenacional</option>
        <option>Arbitro FIVB</option>
      </select>
      <div *ngIf="form.get('categoria2')?.invalid && form.get('categoria2')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <!-- Categoría 3 -->
    <div class="col-md-3">
      <label class="form-label d-flex justify-content-between align-items-center">
        Categoría 3
        <button type="button" class="btn btn-sm btn-link p-0" (click)="editarCategorias('categoria3')">Editar</button>
      </label>
      <select formControlName="categoria3" class="form-select" required>
        <option value="">Seleccione...</option>
        <option>Local</option>
        <option>Regional</option>
        <option>Liga</option>
        <option>Selección</option>
      </select>
      <div *ngIf="form.get('categoria3')?.invalid && form.get('categoria3')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <div class="col-md-3">
      <label class="form-label">Fecha Alta</label>
      <input type="date" formControlName="fechaAlta" class="form-control" required />
      <div *ngIf="form.get('fechaAlta')?.invalid && form.get('fechaAlta')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <!-- Club -->
    <div class="col-md-3">
      <label class="form-label d-flex justify-content-between align-items-center">
        Club
        <button type="button" class="btn btn-sm btn-link p-0" (click)="editarClubes()">Editar</button>
      </label>
      <select formControlName="club" class="form-select" required>
        <option value="">Seleccione...</option>
        <option>Sociedad Española de Jujuy</option>
        <option>Sociedad Italiana de Jujuy</option>
        <option>Club Atletico Gorriti</option>
        <option>Direccion de Deportes</option>
        <option>Club Atletico Independiente</option>
        <option>Club Atletico Ciudad de Nieva</option>
        <option>Club Altos Hornos Zapla</option>
        <option>Club Atletico Talleres</option>
        <option>Club Deportivo Universitario</option>
        <option>Club Deportivo Lujan</option>
        <option>Club Atletico General Lavalle</option>
        <option>Club Gimnasia y Esgrima de Jujuy</option>
        <option>CIDEF Jujuy</option>
        <option>Club Atletico San Pedro</option>
        <option>Club Deportivo Sirio Voley</option>
        <option>Club Sportivo Rivadavia</option>
        <option>Los Ceibos Voley</option>
        <option>Club Academia de Voley</option>
        <option>Club Amigos del Voley</option>
        <option>Autoridades Tecnicas de Control</option>
      </select>
      <div *ngIf="form.get('club')?.invalid && form.get('club')?.touched" class="text-danger">
        Este campo es obligatorio.
      </div>
    </div>

    <!-- Pase -->
    <div class="col-md-3">
      <label class="form-label">Pase (opcional)</label>
      <select formControlName="pase" class="form-select">
        <option value="">Ninguno</option>
        <option>Proveniente</option>
        <option>Destino</option>
        <option>Habilitación</option>
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">Club al que pasa</label>
      <input formControlName="clubDestino" class="form-control" />
    </div>

    <div class="col-md-3">
      <label class="form-label">Fecha Pase</label>
      <input type="date" formControlName="fechaPase" class="form-control" />
    </div>

    <div class="col-12">
      <button class="btn btn-primary" [disabled]="form.invalid">Guardar</button>
    </div>
  </form>

  <!-- Búsqueda -->
  <div class="mt-5">
    <h4>Búsqueda por DNI</h4>
    <input [(ngModel)]="dniBusqueda" class="form-control w-50 d-inline" placeholder="Ingrese DNI" />
    <button class="btn btn-secondary ms-2" (click)="buscar()">Buscar</button>

    <div *ngIf="seleccionado" class="mt-3">
      <h5>Afiliado encontrado:</h5>
      <ul>
        <li><strong>Nombre:</strong> {{ seleccionado.apellidoNombre }}</li>
        <li><strong>DNI:</strong> {{ seleccionado.dni }}</li>
        <li><strong>Club:</strong> {{ seleccionado.club }}</li>
      </ul>
      <qrcode [qrdata]="seleccionado | json" [width]="200"></qrcode>
    </div>
  </div>

  <!-- Tabla -->
  <h4 class="mt-5">Listado</h4>
  <table class="table table-striped table-bordered mt-3">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>DNI</th>
        <th>Club</th>
        <th>Afiliación</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let a of afiliados">
        <td>{{ a.apellidoNombre }}</td>
        <td>{{ a.dni }}</td>
        <td>{{ a.club }}</td>
        <td>{{ a.tipoAfiliacion }}</td>
      </tr>
    </tbody>
  </table>
</div>
