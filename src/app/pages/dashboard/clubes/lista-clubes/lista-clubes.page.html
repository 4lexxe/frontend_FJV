<div class="lista-clubes-container">
  <div class="container py-4">
    <div class="row">
      <div class="col-12">
        <!-- Encabezado -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <div>
            <h2 class="mb-1">Gestión de Clubes</h2>
            <p class="text-muted">Administración de clubes afiliados a la Federación</p>
          </div>
          <a routerLink="/dashboard/clubes/nuevo" class="btn btn-primary">
            <i class="fas fa-plus me-2"></i> Nuevo Club
          </a>
        </div>

        <!-- Filtros -->
        <div class="card shadow-sm mb-4">
          <div class="card-body p-3">
            <h5 class="mb-3">Filtros de búsqueda</h5>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="nombreFilter" class="form-label">Nombre</label>
                <input type="text" id="nombreFilter" class="form-control" [(ngModel)]="filterParams.nombre" placeholder="Buscar por nombre...">
              </div>
              <div class="col-md-4">
                <label for="cuitFilter" class="form-label">CUIT</label>
                <input type="text" id="cuitFilter" class="form-control" [(ngModel)]="filterParams.cuit" placeholder="Ej: 30-71234567-8">
              </div>
              <div class="col-md-4">
                <label for="estadoFilter" class="form-label">Estado de Afiliación</label>
                <select id="estadoFilter" class="form-select" [(ngModel)]="filterParams.estadoAfiliacion">
                  <option value="">Todos los estados</option>
                  @for (estado of estadosAfiliacion; track estado) {
                    <option [value]="estado">{{estado}}</option>
                  }
                </select>
              </div>
              <div class="col-md-6">
                <label for="fechaDesdeFilter" class="form-label">Fecha Afiliación Desde</label>
                <input type="date" id="fechaDesdeFilter" class="form-control" [(ngModel)]="filterParams.fechaAfiliacionDesde">
              </div>
              <div class="col-md-6">
                <label for="fechaHastaFilter" class="form-label">Fecha Afiliación Hasta</label>
                <input type="date" id="fechaHastaFilter" class="form-control" [(ngModel)]="filterParams.fechaAfiliacionHasta">
              </div>
              <div class="col-12 d-flex justify-content-end gap-2">
                <button class="btn btn-outline-secondary" (click)="limpiarFiltros()">
                  <i class="fas fa-times me-2"></i>Limpiar Filtros
                </button>
                <button class="btn btn-primary" (click)="aplicarFiltros()">
                  <i class="fas fa-search me-2"></i>Buscar
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Estado de carga o error -->
        @if (isLoading) {
          <div class="card shadow-sm text-center p-5">
            <div class="spinner-border text-primary mx-auto mb-3" role="status">
              <span class="visually-hidden">Cargando clubes...</span>
            </div>
            <p class="mb-0">Cargando lista de clubes...</p>
          </div>
        } @else if (errorMessage) {
          <div class="alert alert-danger">
            <i class="fas fa-exclamation-circle me-2"></i>
            {{errorMessage}}
          </div>
        } @else if (filteredClubes.length === 0) {
          <div class="card shadow-sm text-center p-5">
            <i class="fas fa-building fa-3x text-muted mb-3"></i>
            <h4>No se encontraron clubes</h4>
            <p class="mb-4">No hay clubes registrados que coincidan con los criterios de búsqueda.</p>
            <a routerLink="/dashboard/clubes/nuevo" class="btn btn-primary mx-auto">
              <i class="fas fa-plus me-2"></i>Registrar Nuevo Club
            </a>
          </div>
        } @else {
          <!-- Tabla de clubes -->
          <div class="card shadow-sm">
            <div class="table-responsive">
              <table class="table table-hover mb-0">
                <thead class="table-light">
                  <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>CUIT</th>
                    <th>Estado</th>
                    <th>Fecha Afiliación</th>
                    <th class="text-center">Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  @for (club of filteredClubes; track club.idClub) {
                    <tr>
                      <td>{{club.idClub}}</td>
                      <td>{{club.nombre}}</td>
                      <td>{{club.email}}</td>
                      <td>{{club.cuit}}</td>
                      <td>
                        @if (club.estadoAfiliacion === 'Activo') {
                          <span class="badge bg-success">{{club.estadoAfiliacion}}</span>
                        } @else if (club.estadoAfiliacion === 'Suspendido') {
                          <span class="badge bg-warning">{{club.estadoAfiliacion}}</span>
                        } @else {
                          <span class="badge bg-secondary">{{club.estadoAfiliacion}}</span>
                        }
                      </td>
                      <td>{{club.fechaAfiliacion | date:'dd/MM/yyyy'}}</td>
                      <td>
                        <div class="d-flex justify-content-center gap-2">
                          <a [routerLink]="['/dashboard/clubes/detalle', club.idClub]" class="btn btn-sm btn-outline-info">
                            <i class="fas fa-eye"></i>
                          </a>
                          <a [routerLink]="['/dashboard/clubes/editar', club.idClub]" class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-edit"></i>
                          </a>
                          <button class="btn btn-sm btn-outline-danger" (click)="eliminarClub(club.idClub || 0)">
                            <i class="fas fa-trash"></i>
                          </button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>
